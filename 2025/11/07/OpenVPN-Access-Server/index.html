<!DOCTYPE html><html lang="jp" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>OpenVPN Access Server | Memorandum!</title><meta name="author" content="ktkr3d"><meta name="copyright" content="ktkr3d"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="OpenVPN Access ServerをRaspberry Pi 4Bに構築してみました。今回はPortainerのGUI画面を使ってOpenVPN Access ServerのDockerコンテナを生成しました。2コネクションまでは無償利用可能なようです。                                     Self-Hosted VPN: Access Server |">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenVPN Access Server">
<meta property="og:url" content="https://ktkr3d.github.io/2025/11/07/OpenVPN-Access-Server/index.html">
<meta property="og:site_name" content="Memorandum!">
<meta property="og:description" content="OpenVPN Access ServerをRaspberry Pi 4Bに構築してみました。今回はPortainerのGUI画面を使ってOpenVPN Access ServerのDockerコンテナを生成しました。2コネクションまでは無償利用可能なようです。                                     Self-Hosted VPN: Access Server |">
<meta property="og:locale">
<meta property="og:image" content="https://openvpn.net/_assets/logo_dark_98a890727a.svg">
<meta property="article:published_time" content="2025-11-07T06:03:02.000Z">
<meta property="article:modified_time" content="2025-11-18T11:38:07.536Z">
<meta property="article:author" content="ktkr3d">
<meta property="article:tag" content="openvpn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://openvpn.net/_assets/logo_dark_98a890727a.svg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "OpenVPN Access Server",
  "url": "https://ktkr3d.github.io/2025/11/07/OpenVPN-Access-Server/",
  "image": "https://openvpn.net/_assets/logo_dark_98a890727a.svg",
  "datePublished": "2025-11-07T06:03:02.000Z",
  "dateModified": "2025-11-18T11:38:07.536Z",
  "author": [
    {
      "@type": "Person",
      "name": "ktkr3d",
      "url": "https://ktkr3d.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://ktkr3d.github.io/2025/11/07/OpenVPN-Access-Server/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MG6LWTJBY0"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-MG6LWTJBY0')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-MG6LWTJBY0', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":false,"highlightLang":false,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'medium_zoom',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OpenVPN Access Server',
  isHighlightShrink: undefined,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css"><script type="text/javascript" src="//www.google.com/jsapi"></script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/rss.xml" title="Memorandum!" type="application/rss+xml">
</head><body><div class="bg-animation" id="web_bg" style="background-color: rgb(227, 233, 199);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">487</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">197</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">31</div></a></div><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Pages</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page child" href="/archlinux/"><i class="fa-fw fa-solid fa-a"></i><span> Arch Linux</span></a></li><li><a class="site-page child" href="/GNOME/"><i class="fa-fw fa-solid fa-g"></i><span> GNOME</span></a></li><li><a class="site-page child" href="/hexo/"><i class="fa-fw fa-solid fa-h"></i><span> Hexo</span></a></li><li><a class="site-page child" href="/To-Do/"><i class="fa-fw fa-solid fa-list"></i><span> To Do</span></a></li><li><a class="site-page child" href="/ubuntu/"><i class="fa-fw fa-brands fa-ubuntu"></i><span> Ubuntu</span></a></li><li><a class="site-page child" href="/Visual-Studio-Code/"><i class="fa-fw fa-solid fa-code"></i><span> Visual Studio Code</span></a></li><li><a class="site-page child" href="/World-of-Warcraft/"><i class="fa-fw fa-solid fa-gamepad"></i><span> World of Warcraft</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Memorandum!</span></a><a class="nav-page-title" href="/"><span class="site-name">OpenVPN Access Server</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Pages</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page child" href="/archlinux/"><i class="fa-fw fa-solid fa-a"></i><span> Arch Linux</span></a></li><li><a class="site-page child" href="/GNOME/"><i class="fa-fw fa-solid fa-g"></i><span> GNOME</span></a></li><li><a class="site-page child" href="/hexo/"><i class="fa-fw fa-solid fa-h"></i><span> Hexo</span></a></li><li><a class="site-page child" href="/To-Do/"><i class="fa-fw fa-solid fa-list"></i><span> To Do</span></a></li><li><a class="site-page child" href="/ubuntu/"><i class="fa-fw fa-brands fa-ubuntu"></i><span> Ubuntu</span></a></li><li><a class="site-page child" href="/Visual-Studio-Code/"><i class="fa-fw fa-solid fa-code"></i><span> Visual Studio Code</span></a></li><li><a class="site-page child" href="/World-of-Warcraft/"><i class="fa-fw fa-solid fa-gamepad"></i><span> World of Warcraft</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">OpenVPN Access Server</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-07T06:03:02.000Z" title="Created 2025-11-07 15:03:02">2025-11-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-18T11:38:07.536Z" title="Updated 2025-11-18 20:38:07">2025-11-18</time></span></div><div class="meta-secondline"></div></div></div><article class="container post-content" id="article-container"><p>OpenVPN Access ServerをRaspberry Pi 4Bに構築してみました。<br>今回はPortainerのGUI画面を使ってOpenVPN Access ServerのDockerコンテナを生成しました。<br>2コネクションまでは無償利用可能なようです。</p>
<a href="https://openvpn.net/access-server/" target="_blank" rel="external nofollow noopener noreferrer" class="link-preview">
    <div class="og-image">
        <img src="https://openvpn.net/_assets/logo_dark_98a890727a.svg" alt="Self-Hosted VPN: Access Server | OpenVPN" class="not-gallery-item" loading="lazy"></div>
        <div class="descriptions">
            <div class="og-title">Self-Hosted VPN: Access Server | OpenVPN</div>
            <div class="og-description">Secure your private business network with a self-hosted VPN, Access Server, ideal for cloud or on-premise setups. Free with 2 simultaneous VPN connections.</div></div></a>

<p><a target="_blank" rel="noopener" href="https://openvpn.net/access-server/">https://openvpn.net/access-server/</a><br><a target="_blank" rel="noopener" href="https://hub.docker.com/r/openvpn/openvpn-as">https://hub.docker.com/r/openvpn/openvpn-as</a></p>
<h4 id="2025-11-15"><a href="#2025-11-15" class="headerlink" title="2025-11-15"></a>2025-11-15</h4><p><a target="_blank" rel="noopener" href="https://docs.portainer.io/faqs/known-issues/known-compatibility-issues-with-docker-engine-29.0.0">https://docs.portainer.io/faqs/known-issues/known-compatibility-issues-with-docker-engine-29.0.0</a><br>PortainerはDocker 29と互換性がないという情報があったので試してみました。確かにDocker 29にバージョンアップしたところ動作しなくなりましたが以下のワークアラウンドで動作するようになりました。<br><a target="_blank" rel="noopener" href="https://github.com/portainer/portainer/issues/12925#issuecomment-3516549977">https://github.com/portainer/portainer/issues/12925#issuecomment-3516549977</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl edit docker.service</span><br><span class="line"><span class="comment"># sudo EDITOR=vim systemctl edit docker.service</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Environment</span>=DOCKER_MIN_API_VERSION=<span class="number">1.24</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart docker.service</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h3 id="環境"><a href="#環境" class="headerlink" title="環境"></a>環境</h3><ul>
<li>Raspbeyy Pi 4B<ul>
<li>Ubuntu 24.04 LTS (Arm64)<ul>
<li>Docker 28.5.2<ul>
<li>Portainer-CE 2.33.3</li>
<li>OpenVPN Access Server 3.0.1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/openvpn-as.drawio.svg"></p>
<h3 id="構築"><a href="#構築" class="headerlink" title="構築"></a>構築</h3><h4 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h4><ul>
<li>構築済のものを使用</li>
</ul>
<h4 id="Portainer"><a href="#Portainer" class="headerlink" title="Portainer"></a>Portainer</h4><ul>
<li>構築済のものを使用</li>
</ul>
<h4 id="OpenVPN関連パラメタの整理"><a href="#OpenVPN関連パラメタの整理" class="headerlink" title="OpenVPN関連パラメタの整理"></a>OpenVPN関連パラメタの整理</h4><ul>
<li><p>指定するパラメタ</p>
<table>
<thead>
<tr>
<th align="left">項目</th>
<th align="left">値（例）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">外部公開IPアドレス</td>
<td align="left">xxx.xxx.xxx.xxx</td>
</tr>
<tr>
<td align="left">外部公開ポート番号(TCP)</td>
<td align="left">60000</td>
</tr>
<tr>
<td align="left">外部からアクセスしたいLANサブネット</td>
<td align="left">192.168.1.0&#x2F;24</td>
</tr>
</tbody></table>
</li>
</ul>
<h4 id="PortainerでDockerコンテナを作成"><a href="#PortainerでDockerコンテナを作成" class="headerlink" title="PortainerでDockerコンテナを作成"></a>PortainerでDockerコンテナを作成</h4><ol>
<li><p>Portainerにログイン<br> <a target="_blank" rel="noopener" href="https://192.168.11.24:9443/">https://192.168.11.24:9443</a></p>
</li>
<li><p>Containersメニューで<kbd>Add Container</kbd></p>
</li>
<li><p>以下のパラメタを指定して<kbd>Deploy the container</kbd></p>
<table>
<thead>
<tr>
<th align="left">分類</th>
<th align="left">項目</th>
<th align="left">値</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&nbsp;</td>
<td align="left">Name</td>
<td align="left">openvpn-as</td>
</tr>
<tr>
<td align="left">Image Configuration</td>
<td align="left">Image</td>
<td align="left">openvpn&#x2F;openvpn-as:latest</td>
</tr>
<tr>
<td align="left">Network ports configuration</td>
<td align="left">Port mapping</td>
<td align="left">943, 943, tcp</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
<td align="left">&lt;外部公開ポート番号&gt;, &lt;外部公開ポート番号&gt;, tcp</td>
</tr>
<tr>
<td align="left">Advanced container settings</td>
<td align="left">Restart Policy</td>
<td align="left">Unless stopped</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">Capabilities</td>
<td align="left">NET_ADMIN</td>
</tr>
</tbody></table>
</li>
<li><p>Cotainers &gt; <code>openvpn-as</code>を選択</p>
</li>
<li><p>Container details &gt; Container status &gt; Logs を選択</p>
</li>
<li><p>Container logsで<code>openvpn</code>アカウントのパスワードを確認</p>
<ul>
<li><p>検索条件</p>
<table>
<thead>
<tr>
<th align="left">検索条件</th>
<th align="left">指定値</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Search</td>
<td align="left">pass</td>
</tr>
<tr>
<td align="left">Lines</td>
<td align="left">1000</td>
</tr>
</tbody></table>
</li>
<li><p>検索結果(例)</p>
  <figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">Auto-generated pass <span class="operator">=</span> <span class="string">&quot;i2vTb42zklZu&quot;</span>. Setting in db...</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h4 id="OpenVPN-Access-Serverの設定"><a href="#OpenVPN-Access-Serverの設定" class="headerlink" title="OpenVPN Access Serverの設定"></a>OpenVPN Access Serverの設定</h4><ol>
<li><p>OpenVPN Access Serverにユーザ名<code>openvpn</code>でログイン<br> <a target="_blank" rel="noopener" href="https://192.168.11.2:943/admin">https://192.168.11.2:943/admin</a></p>
 <div class="note info flat"><p>ログから検索したパスワードを指定します。</p>
</div>
</li>
<li><p>アカウント<code>openvpn</code>のパスワードを更新<br> Users &gt; <code>openvpn</code> &gt; User Settings &gt; Authentication &gt; New password</p>
</li>
<li><p>VPNサーバのパラメタ設定<br> VPN Server &gt; Network Settings で以下を設定</p>
<table>
<thead>
<tr>
<th align="left">項目</th>
<th align="left">値</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Server Address &#x2F; Hostname (or IP address)</td>
<td align="left">&lt;外部公開IPアドレス&gt;</td>
</tr>
<tr>
<td align="left">OpenVPN daemons &#x2F; Protocol</td>
<td align="left">TCP</td>
</tr>
<tr>
<td align="left">TCP Port</td>
<td align="left">&lt;外部公開ポート番号&gt;</td>
</tr>
</tbody></table>
</li>
<li><p>ユーザを作成<br> Usersメニューで<kbd>Add New User</kbd><br> <code>User01</code>を追加</p>
</li>
<li><p>ユーザのパスワードを設定<br> Users &gt; <code>User01</code> &gt; User Settings &gt; Authentication &gt; New password</p>
</li>
<li><p>ユーザのプロファイルを作成<br> Certificate Management &gt; VPN Client Certificates &gt;     New Connection Profile &gt; Username &gt; <code>User01</code><br> <kbd>Download</kbd></p>
</li>
<li><p>ファイル名変更<br> <code>profile-userlocked.ovpn</code> → <code>profile-User01.opvn</code></p>
</li>
<li><p>LANへの接続を許可<br> Access Controls &gt; Global Access Rules &gt; NAT &gt;         Subnet で<kbd>+ Add new subnet</kbd><br> <code>192.168.11.0/24</code>を追加</p>
</li>
<li><p><kbd>Restart</kbd>で再起動</p>
</li>
</ol>
<h4 id="Status画面のwarningについて"><a href="#Status画面のwarningについて" class="headerlink" title="Status画面のwarningについて"></a>Status画面のwarningについて</h4><ul>
<li><p>CPU AES acceleration not available</p>
<blockquote>
<p>OpenVPN Access Server was not able to detect AES acceleration instruction on the CPU (AES-NI on x86_64&#x2F;ARMv8 AES extensions). This often caused by virtualization not passing through the CPU features.</p>
</blockquote>
<p>  Raspberry Pi 4Bに搭載されているBroadcom BCM2711プロセッサは、AESハードウェアアクセラレーション命令をサポートしていません。 一方で、ASIMD (Advanced SIMD、またはNEON) 命令はサポートしています。<br>  そのままにします。カスタマイズしたい場合は以下を操作すればよいかもしれません。</p>
<p>  VPN Server &gt; Security &#x2F; Encryption &gt; Data-channel ciphers</p>
</li>
<li><p>OpenVPN data-channel offloading was requested but failed to activate</p>
<blockquote>
<p>OpenVPN data-channel offloading was requested but failed to activate. This typically happens if there is a configuration option that is incompatible with DCO or if the DCO kernel module could not be loaded.</p>
</blockquote>
<p>  以下で抑止できます。<br>  VPN Server &gt; Data Channel Offload &gt; Use DCO if possible<br>  <code>Off</code></p>
</li>
</ul>
<h4 id="クライアントの設定"><a href="#クライアントの設定" class="headerlink" title="クライアントの設定"></a>クライアントの設定</h4><ol>
<li>OpenVPN Connectアプリをインストール</li>
<li>OpenVPN Connectアプリで<code>profile-User01.opvn</code> をインポート</li>
</ol>
<h4 id="ルータの設定"><a href="#ルータの設定" class="headerlink" title="ルータの設定"></a>ルータの設定</h4><ul>
<li>ポート変換<br>  インターネットからの&lt;外部公開ポート番号&gt;宛ての通信をRaspberry Pi 4BのIPアドレスの&lt;外部公開ポート番号&gt;宛てに変換</li>
</ul>
<h4 id="Ubuntuのファイアウォール設定"><a href="#Ubuntuのファイアウォール設定" class="headerlink" title="Ubuntuのファイアウォール設定"></a>Ubuntuのファイアウォール設定</h4><ul>
<li>受信設定<br>  &lt;外部公開ポート番号&gt;&#x2F;tcp、943&#x2F;tcpへの受信許可を追加</li>
</ul>
<h4 id="コンテナの自動アップデート設定"><a href="#コンテナの自動アップデート設定" class="headerlink" title="コンテナの自動アップデート設定"></a>コンテナの自動アップデート設定</h4><ol>
<li><p>Portainerでwatchtowerコンテナを作成</p>
<table>
<thead>
<tr>
<th align="left">項目</th>
<th align="left">値</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Name</td>
<td align="left">watchtower</td>
</tr>
<tr>
<td align="left">Image</td>
<td align="left">containrrr&#x2F;watchtower:latest</td>
</tr>
<tr>
<td align="left">Volume(Bind)</td>
<td align="left">&#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock</td>
</tr>
<tr>
<td align="left">Restart policies</td>
<td align="left">Unless Stopped</td>
</tr>
</tbody></table>
 <div class="note info flat"><p>デフォルト設定では全てのコンテナを対象とした初回のチェックが24時間後にスケジュールされました。</p>
</div>

 <div class="note info flat"><p>VPNは狙われやすいので最新バージョンを保つようにしよう。</p>
</div></li>
</ol>
<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><h4 id="Arch-Linuxクライアントからの接続"><a href="#Arch-Linuxクライアントからの接続" class="headerlink" title="Arch Linuxクライアントからの接続"></a>Arch Linuxクライアントからの接続</h4><p>Arch LinuxにOpenVPN接続プロファイルをインポートしてインターネット経由で接続し、LAN内のOpenVPNの管理者画面を表示</p>
<p><img src="/images/arch_openvpn.png"></p>
<h4 id="スマートフォンからの接続"><a href="#スマートフォンからの接続" class="headerlink" title="スマートフォンからの接続"></a>スマートフォンからの接続</h4><p>OpenVPN接続プロファイルをインポートしてインターネット経由で接続<br>外出中にEPGStationの表示や予約ができて便利</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/openvpn/">openvpn</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/17/Caelestia/" title="Caelestia"><img class="cover" src="/images/caelestia.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Caelestia</div></div><div class="info-2"><div class="info-item-1"> Hyprland用のCaelestia dotsを試してみました。これは良いかもしれない。 https://github.com/caelestia-dots/caelestiahttps://github.com/caelestia-dots/clihttps://github.com/caelestia-dots/shell   https://www.youtube.com/watch?v=TggHDm0_vBw   環境ハードウェア デスクトップPC、日本語キーボード配列、4Kディスプレイ 2 in 1 PC、英語キーボード配列、1200x1920タッチスクリーン  ソフトウェア Arch Linux gdm 49.1 hyprland 0.25.1 quickshell 0.2.0 caelestia-shell 1.3.3   fish 4.2.1    インストールバックアップ 設定ファイルのバックアップ  設定ファイルが上書きされるのでバックアップ推奨です。上書き確認はあります。  ~/.config/├── btop/           -&gt; ~/.l...</div></div></div></a><a class="pagination-related" href="/2025/10/30/Install-Arch-Linux-on-WSL/" title="Install Arch Linux on WSL"><img class="cover" src="https://www.pikpng.com/pngl/b/201-2013443_600px-arch-linux-logo-arch-linux-logo-svg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Install Arch Linux on WSL</div></div><div class="info-2"><div class="info-item-1">WSLにArch Linuxをインストールします。Ubuntu上のfish, ssh, code server, hexo, jellyfinをArch Linuxに移行します。 https://wiki.archlinux.org/title/Install_Arch_Linux_on_WSL   環境Software Widows 11 Pro wsl 2.6.1 Arch Linux fish 4.1.2 starship v1.24.0 code-server v4.105.1 hexo 8.1.0 hexo-theme-butterfly 5.5.1   jellyfin 10.11.0   Ubuntu (現行のデフォルト)      Ports   port 用途    22 ssh   443 code-server   4000 hexo s   8096 jellyfin   構築Arch Linux導入 WSLをアップデート wsl --update Arch Linuxをインストール 管理者で実行wsl --install archlinuxwsl --l...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2019/08/17/Pritunl/" title="RPi4 - Pritunl"><img class="cover" src="/images/pritunl.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-17</div><div class="info-item-2">RPi4 - Pritunl</div></div><div class="info-2"><div class="info-item-1">https://pritunl.com/https://opensource.com/article/19/1/pritunl-vpn-raspberry-pipritunl はVPN サーバの構築と管理をしてくれるOSSで、OpenVPN を使っています。Raspberry Pi 4 に環境を構築して、OpenVPN クライアントから接続してみました。操作が簡単で便利ですね。   環境 Raspberry Pi 4B Ubuntu Server 19.10 aarch64  構築以下の手順に従って構築します。いくつかカスタマイズしています。https://opensource.com/article/19/1/pritunl-vpn-raspberry-pi 前提パッケージ$ sudo apt-get -y install build-essential git bzr python python-dev python-pip net-tools openvpn bridge-utils psmisc golang-go libffi-dev mongodb libssl-de...</div></div></div></a><a class="pagination-related" href="/2020/08/24/OpenVPN-on-WSL2/" title="OpenVPN on WSL2"><img class="cover" src="/images/openvpn_wsl.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-24</div><div class="info-item-2">OpenVPN on WSL2</div></div><div class="info-2"><div class="info-item-1">https://github.com/pritunl/pritunlWSL2 の環境にOpenVPN を導入してみました。Pritunl を管理ツールとして使いました。外出先から自宅環境のファイルサーバの参照、EPGStation の操作、WSL2 への接続、Windows 10 へのリモートデスクトップ接続、等ができます。今まではRaspberry Pi をVPN サーバにしていました。リスクがある気もしますが移行を検討してみます。   環境 Windows 10 Insider Preview Build 20197 WSL2 (Ubuntu 20.04) openvpn 2.4.7 pritunl 1.29.2530.72ℹ️Wireguard を指定する項目が増えていました mongodb 3.6.9     v6 プラスでインターネット接続   v6 プラス接続環境の調査 公開IPv4 アドレスと公開IPv6 アドレスを確認  https://test-ipv6.com/ 公開IPv6 アドレスから公開可能なポート番号を確認  http://ipv4.web.fc2.c...</div></div></div></a><a class="pagination-related" href="/2015/08/08/OpenVPN-with-Raspberry-Pi/" title="OpenVPN with Raspberry Pi"><img class="cover" src="/images/openvpn.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2015-08-08</div><div class="info-item-2">OpenVPN with Raspberry Pi</div></div><div class="info-2"><div class="info-item-1">https://openvpn.net/OpenVPN を使ってインターネットから自宅のサーバネットワークにセキュアに接続してみました。    機器 構成    VPN サーバ - Raspberry Pi 2- Ubuntu 14.04 (ARM) - OpenVPN 2.3.2   Linux クライアント - Ubutu GNOME 15.10 (x86_64) - GNOME Shell 3.17.4   Android クライアント - Android 4.4.2- OpenVPN アプリ     VPN サーバの設定はじめにRaspbery Pi はRTC(Real Time Clock)を持っていないので、ntp で時刻同期をしておきます。 /etc/ntp.conf#server 0.ubuntu.pool.ntp.org iburst#server 1.ubuntu.pool.ntp.org iburst#server 2.ubuntu.pool.ntp.org iburst#server 3.ubuntu.pool.ntp.org iburstpool ntp...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ktkr3d</div><div class="author-info-description">Memorandum</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">487</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">197</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">31</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ktkr3d"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ktkr3d" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://gist.github.com/ktkr3d" target="_blank" title="Gist"><i class="fas fa-code" style="color: #24292e;"></i></a><a class="social-icon" href="https://x.com/ktkr3d" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #24292e;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#2025-11-15"><span class="toc-number">1.</span> <span class="toc-text">2025-11-15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%92%B0%E5%A2%83"><span class="toc-number">2.</span> <span class="toc-text">環境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A7%8B%E7%AF%89"><span class="toc-number">3.</span> <span class="toc-text">構築</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker"><span class="toc-number">3.1.</span> <span class="toc-text">Docker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portainer"><span class="toc-number">3.2.</span> <span class="toc-text">Portainer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OpenVPN%E9%96%A2%E9%80%A3%E3%83%91%E3%83%A9%E3%83%A1%E3%82%BF%E3%81%AE%E6%95%B4%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text">OpenVPN関連パラメタの整理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portainer%E3%81%A7Docker%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A%E3%82%92%E4%BD%9C%E6%88%90"><span class="toc-number">3.4.</span> <span class="toc-text">PortainerでDockerコンテナを作成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OpenVPN-Access-Server%E3%81%AE%E8%A8%AD%E5%AE%9A"><span class="toc-number">3.5.</span> <span class="toc-text">OpenVPN Access Serverの設定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Status%E7%94%BB%E9%9D%A2%E3%81%AEwarning%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><span class="toc-number">3.6.</span> <span class="toc-text">Status画面のwarningについて</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A"><span class="toc-number">3.7.</span> <span class="toc-text">クライアントの設定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%83%AB%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%AD%E5%AE%9A"><span class="toc-number">3.8.</span> <span class="toc-text">ルータの設定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ubuntu%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%82%A2%E3%82%A6%E3%82%A9%E3%83%BC%E3%83%AB%E8%A8%AD%E5%AE%9A"><span class="toc-number">3.9.</span> <span class="toc-text">Ubuntuのファイアウォール設定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A%E3%81%AE%E8%87%AA%E5%8B%95%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88%E8%A8%AD%E5%AE%9A"><span class="toc-number">3.10.</span> <span class="toc-text">コンテナの自動アップデート設定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Arch-Linux%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%81%8B%E3%82%89%E3%81%AE%E6%8E%A5%E7%B6%9A"><span class="toc-number">4.1.</span> <span class="toc-text">Arch Linuxクライアントからの接続</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%82%B9%E3%83%9E%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%B3%E3%81%8B%E3%82%89%E3%81%AE%E6%8E%A5%E7%B6%9A"><span class="toc-number">4.2.</span> <span class="toc-text">スマートフォンからの接続</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/06/Faugus-Launcher/" title="Faugus Launcher">Faugus Launcher</a><time datetime="2025-12-06T06:14:20.000Z" title="Created 2025-12-06 15:14:20">2025-12-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/01/SDDM/" title="SDDM">SDDM</a><time datetime="2025-12-01T08:35:57.000Z" title="Created 2025-12-01 17:35:57">2025-12-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/30/Walker/" title="Walker">Walker</a><time datetime="2025-11-30T13:18:02.000Z" title="Created 2025-11-30 22:18:02">2025-11-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/29/CachyOS/" title="CachyOS">CachyOS</a><time datetime="2025-11-28T23:05:23.000Z" title="Created 2025-11-29 08:05:23">2025-11-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/17/Caelestia/" title="Caelestia">Caelestia</a><time datetime="2025-11-17T13:18:22.000Z" title="Created 2025-11-17 22:18:22">2025-11-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/travel.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2010 - 2025 By ktkr3d</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null
  const getUtterancesTheme = theme => theme === 'dark' ? 'photon-dark' : 'github-light'

  const loadUtterances = (el = document, key) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyUtterances = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const config = {
      src: 'https://utteranc.es/client.js',
      repo: 'ktkr3d/ktkr3d.github.io',
      theme: getUtterancesTheme(document.documentElement.getAttribute('data-theme')),
      crossorigin: 'anonymous',
      async: true,
      ...option,
      'issue-term': isShuoshuo ? key : (option && option['issue-term']) || 'pathname'
    }

    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => ele.setAttribute(key, value))
    el.querySelector('#utterances-wrap').appendChild(ele)
  }

  const changeUtterancesTheme = theme => {
    const iframe = document.querySelector('#utterances-wrap iframe')
    if (iframe) {
      const message = {
        type: 'set-theme',
        theme: getUtterancesTheme(theme)
      };
      iframe.contentWindow.postMessage(message, 'https://utteranc.es')
    }
  }

  btf.addGlobalFn('themeChange', changeUtterancesTheme, 'utterances')

  if (isShuoshuo) {
    'Utterances' === 'Utterances'
      ? window.shuoshuoComment = { loadComment: loadUtterances }
      : window.loadOtherComment = loadUtterances
    return
  }
  
  if ('Utterances' === 'Utterances' || !false) {
    if (false) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
    else loadUtterances()
  } else {
    window.loadOtherComment = loadUtterances
  }
})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="local-search-input"><input placeholder="Search for Posts" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>